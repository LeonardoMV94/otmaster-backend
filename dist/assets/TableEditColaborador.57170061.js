import{a5 as F,ca as G,n as p,ap as L,ao as Y,aA as Z,Y as H,a4 as a,b3 as l,cC as A,z as d,j as Q,cg as J,cQ as W,cR as X,Z as U,G as i,cS as $,b5 as I,bS as _,cf as f,bR as S,a3 as c,bq as g,br as y}from"./index.b87efa9c.js";import{a as oo,g as ao,Q as eo}from"./QTable.f511fa1b.js";import{Q as lo,a as m,b as V,C as R}from"./ClosePopup.bd2b40ce.js";import{b as to,Q as ro}from"./QItem.18e3eea6.js";import{c as no}from"./Notifications.79b82ee7.js";import{u as so}from"./useAuth.9f637a4e.js";import{u as uo}from"./useColaboradores.7d2468f0.js";import{u as io}from"./useRoles.b61c86d9.js";const mo={class:"q-pa-md"},co={class:"q-ml-sm"},bo={class:"text-pre-wrap"},po=c(" No hay roles "),Qo={__name:"TableEditColaborador",setup(_o){const k=F(()=>G(()=>import("./FormColaborador.b36cd5f0.js"),["assets/FormColaborador.b36cd5f0.js","assets/FormColaborador.e24d07a8.css","assets/index.b87efa9c.js","assets/index.d6902eec.css","assets/QItem.18e3eea6.js","assets/QTable.f511fa1b.js","assets/QForm.4d1a6ee1.js","assets/useRoles.b61c86d9.js","assets/Notifications.79b82ee7.js","assets/useColaboradores.7d2468f0.js"])),{isAdmin:E}=so(),{getAllRoles:N,getRolestoSelect:h}=io(),{getAllColaboradores:x,getColaboradores:P,updateColaborador:b,deleteColaborador:T}=uo();let s=p(!1),u=p(!1),w=p(null);const v=p(""),j=()=>{s.value=!s.value},B=r=>{w.value=r,u.value=!u.value},D=[{name:"rut_colaborador",label:"Rut Colaborador",align:"center",field:"rut_colaborador",sortable:!0},{name:"nombre_colaborador",align:"center",label:"Nombre Colaborador",field:"nombreColaborador",sortable:!0},{name:"appat_colaborador",align:"center",label:"Apellido Paterno",field:"appat_colaborador",sortable:!0},{name:"apmat_colaborador",align:"center",label:"Apellido Materno",field:"apmat_colaborador",sortable:!0},{name:"roles.nombre_rol",align:"center",label:"Tipo de Rol",field:"roles.nombre_rol",sortable:!0},{name:"acciones",label:"Acciones",field:"acciones",align:"center"}],M=async(r,t)=>{const o={nombre_colaborador:t};console.log("editarItemNombre",r,o),await b(r,o)},O=async(r,t)=>{const o={appat_colaborador:t};console.log("editarItemApPat",r,o),await b(r,o)},K=async(r,t)=>{const o={apmat_colaborador:t};console.log("editarItemApMat",r,o),await b(r,o)},q=async(r,t)=>{const o={rolesIdRol:t};console.log("editarItemRol",r,o),await b(r,o)},z=async r=>{E?(console.log("delete permitido",r),await T(r)):(console.log("no hay permisos"),no("No tiene permisos de Administrador para eliminar","negative"))},C=async()=>{await x(),await N()};return L(async()=>{await C()}),Y(async()=>{await C()}),(r,t)=>(Z(),H("div",mo,[a(eo,{title:"Administraci\xF3n de Colaboradores",rows:d(P),columns:D,filter:v.value,"row-key":"name","binary-state-sort":""},{top:l(()=>[a(A,{modelValue:d(s),"onUpdate:modelValue":t[0]||(t[0]=o=>Q(s)?s.value=o:s=o)},{default:l(()=>[a(d(k))]),_:1},8,["modelValue"]),a(A,{modelValue:d(u),"onUpdate:modelValue":t[2]||(t[2]=o=>Q(u)?u.value=o:u=o),persistent:""},{default:l(()=>[a(J,{class:""},{default:l(()=>[a(W,{class:"row items-center"},{default:l(()=>[a(X,{icon:"warning",color:"warning","text-color":"white"}),U("span",co,"\xBFEst\xE1s seguro de eliminar el colaborador con rut "+i(d(w))+" ?",1)]),_:1}),a($,{align:"right"},{default:l(()=>[I(a(_,{flat:"",label:"Cancelar",color:"primary"},null,512),[[R]]),I(a(_,{flat:"",label:"Confirmar",color:"negative",onClick:t[1]||(t[1]=o=>z(d(w)))},null,512),[[R]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(_,{color:"primary",label:"A\xF1adir Colaborador",icon:"add",onClick:j}),a(oo),a(f,{modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=o=>v.value=o),outlined:"",dense:"",debounce:"300",color:"primary"},{append:l(()=>[a(S,{name:"search"})]),_:1},8,["modelValue"])]),body:l(o=>[a(lo,{props:o},{default:l(()=>[a(m,{key:"rut_colaborador",props:o},{default:l(()=>[c(i(o.row.rut_colaborador),1)]),_:2},1032,["props"]),a(m,{key:"nombre_colaborador",props:o},{default:l(()=>[c(i(o.row.nombre_colaborador)+" ",1),a(V,{modelValue:o.row.nombre_colaborador,"onUpdate:modelValue":e=>o.row.nombre_colaborador=e,title:"Editar Nombre",buttons:"",persistent:"",onSave:e=>M(o.row.rut_colaborador,e)},{default:l(e=>[a(f,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,autofocus:"",counter:"",onKeyup:t[4]||(t[4]=g(y(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(m,{key:"appat_colaborador",props:o},{default:l(()=>[U("div",bo,[c(i(o.row.appat_colaborador)+" ",1),a(V,{modelValue:o.row.appat_colaborador,"onUpdate:modelValue":e=>o.row.appat_colaborador=e,title:"Editar apellido paterno",buttons:"",persistent:"",onSave:e=>O(o.row.rut_colaborador,e)},{default:l(e=>[a(f,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,autofocus:"",counter:"",onKeyup:t[5]||(t[5]=g(y(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])])]),_:2},1032,["props"]),a(m,{key:"apmat_colaborador",props:o},{default:l(()=>[c(i(o.row.apmat_colaborador)+" ",1),a(V,{modelValue:o.row.apmat_colaborador,"onUpdate:modelValue":e=>o.row.apmat_colaborador=e,title:"Editar apellido materno",buttons:"",persistent:"",onSave:e=>K(o.row.rut_colaborador,e)},{default:l(e=>[a(f,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,autofocus:"",counter:"",onKeyup:t[6]||(t[6]=g(y(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(m,{key:"roles.nombre_rol",props:o},{default:l(()=>[c(i(o.row.roles.nombre_rol)+" ",1),a(V,{modelValue:o.rolesIdRol,"onUpdate:modelValue":e=>o.rolesIdRol=e,title:"Editar rol",buttons:"",persistent:"",onSave:e=>q(o.row.rut_colaborador,e.id_rol)},{default:l(e=>[a(ao,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,outlined:"","label-color":"primary","input-debounce":"0","map-options":"",behavior:"menu",options:d(h)},{"no-option":l(()=>[a(to,null,{default:l(()=>[a(ro,{class:"text-grey"},{default:l(()=>[po]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(m,{key:"acciones",props:o},{default:l(()=>[a(_,{push:"",round:"",color:"red",onClick:e=>B(o.row.rut_colaborador)},{default:l(()=>[a(S,{name:"delete"})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])]))}};export{Qo as default};
