import{a5 as x,ca as B,n as d,ap as P,ao as j,aA as q,Y as K,a4 as o,b3 as a,cj as b,z as i,j as N,ck as M,cl as O,cm as z,Z as F,G as p,cn as G,b5 as w,bS as m,co as v,bR as g,a3 as V,bq as L,br as Y}from"./index.6be16f63.js";import{Q as Z,e as H,f,g as J,i as W,C as y}from"./ClosePopup.d0a73f30.js";import{c as X}from"./Notifications.d579e4b1.js";import{u as $}from"./useAuth.5537e7f8.js";import{u as ee}from"./useRoles.e63fcc0c.js";import"./QItem.1a96ea91.js";const oe={class:"q-pa-md"},ae={class:"q-ml-sm"},me={__name:"TableEditRoles",setup(le){const C=x(()=>B(()=>import("./FormRoles.31e41112.js"),["assets/FormRoles.31e41112.js","assets/FormRoles.82a85294.css","assets/index.6be16f63.js","assets/index.d6902eec.css","assets/QForm.99f3ffd3.js","assets/useRoles.e63fcc0c.js","assets/Notifications.d579e4b1.js"])),{isAdmin:Q}=$(),{getAllRoles:R,getRoles:k,updateRol:A,deleteRol:I}=ee();let n=d(!1),s=d(!1),u=d(null);const c=d(""),h=()=>{n.value=!n.value},D=t=>{u.value=t,s.value=!s.value},E=[{name:"id_rol",label:"ID",align:"center",field:"id_rol",sortable:!0},{name:"nombre_rol",align:"center",label:"Nombre del Rol",field:"nombre_rol",sortable:!0},{name:"acciones",align:"center",label:"Acciones",field:"acciones",sortable:!0}],S=async(t,l)=>{const e={nombre_rol:l};console.log("editarItemNombreRol",t,e),await A(t,e)},U=async t=>{Q?(console.log("delete permitido",t),await I(t)):(console.log("no hay permisos"),X("No tiene permisos de Administrador para eliminar","negative"))},_=async()=>{await R()};return P(async()=>{await _()}),j(async()=>{await _()}),(t,l)=>(q(),K("div",oe,[o(W,{title:"Administraci\xF3n de Roles",rows:i(k),columns:E,filter:c.value,"row-key":"name","binary-state-sort":""},{top:a(()=>[o(b,{modelValue:i(n),"onUpdate:modelValue":l[0]||(l[0]=e=>N(n)?n.value=e:n=e)},{default:a(()=>[o(i(C))]),_:1},8,["modelValue"]),o(b,{modelValue:i(s),"onUpdate:modelValue":l[2]||(l[2]=e=>N(s)?s.value=e:s=e),persistent:""},{default:a(()=>[o(M,{class:""},{default:a(()=>[o(O,{class:"row items-center"},{default:a(()=>[o(z,{icon:"warning",color:"warning","text-color":"white"}),F("span",ae,"\xBFEst\xE1s seguro de eliminar el rol con ID "+p(i(u))+" ?",1)]),_:1}),o(G,{align:"right"},{default:a(()=>[w(o(m,{flat:"",label:"Cancelar",color:"primary"},null,512),[[y]]),w(o(m,{flat:"",label:"Confirmar",color:"negative",onClick:l[1]||(l[1]=e=>U(i(u)))},null,512),[[y]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(m,{color:"primary",label:"A\xF1adir nuevo rol",icon:"add",onClick:h}),o(Z),o(v,{modelValue:c.value,"onUpdate:modelValue":l[3]||(l[3]=e=>c.value=e),outlined:"",dense:"",debounce:"300",color:"primary"},{append:a(()=>[o(g,{name:"search"})]),_:1},8,["modelValue"])]),body:a(e=>[o(H,{props:e},{default:a(()=>[o(f,{key:"id_rol",props:e},{default:a(()=>[V(p(e.row.id_rol),1)]),_:2},1032,["props"]),o(f,{key:"nombre_rol",props:e},{default:a(()=>[V(p(e.row.nombre_rol)+" ",1),o(J,{modelValue:e.row.nombre_rol,"onUpdate:modelValue":r=>e.row.nombre_rol=r,title:"Editar nombre de rol",buttons:"",persistent:"",onSave:r=>S(e.row.id_rol,r)},{default:a(r=>[o(v,{modelValue:r.value,"onUpdate:modelValue":T=>r.value=T,autofocus:"",counter:"",clearable:"",mask:"NNNNNNNNNNNNNNNNNNNNNN","unmasked-value":"",onKeyup:l[4]||(l[4]=L(Y(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),o(f,{key:"acciones",props:e},{default:a(()=>[o(m,{push:"",round:"",color:"red",onClick:r=>D(e.row.id_rol)},{default:a(()=>[o(g,{name:"delete"})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])]))}};export{me as default};
