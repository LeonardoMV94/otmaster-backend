var Pe=Object.defineProperty,xe=Object.defineProperties;var Ue=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var Ie=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var ne=(o,s,r)=>s in o?Pe(o,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[s]=r,O=(o,s)=>{for(var r in s||(s={}))Ie.call(s,r)&&ne(o,r,s[r]);if(ie)for(var r of ie(s))Oe.call(s,r)&&ne(o,r,s[r]);return o},z=(o,s)=>xe(o,Ue(s));import{bD as Te,bE as Qe,cf as De,bG as Be,n as E,V as R,cg as qe,bI as Ne,ch as je,bK as Me,ci as He,a_ as se,aq as re,bB as ue,bw as de,bX as Ke,ae as te,b8 as Le,ab as $e,bO as Ge,bC as We,b$ as Fe,a5 as Je,ca as ze,ap as Xe,ao as Ye,aA as X,Y,a4 as a,b3 as l,cj as ce,z as m,j as me,ck as Ze,cl as et,cm as tt,Z as oe,G as d,cn as ot,b5 as fe,bS as j,co as M,bR as be,a3 as f,bq as Z,br as at,K as ge,aG as lt}from"./index.efe594f0.js";import{u as it,v as ve,a as nt,p as _e,b as st,c as rt,r as pe,s as ut,d as dt,Q as ct,e as mt,f as k,g as Q,h as ke,i as ft,C as ye}from"./ClosePopup.eeaa7ac3.js";import{c as we,b as he,Q as Ve}from"./QItem.7ffcb426.js";import{c as bt}from"./Notifications.fda502fa.js";import{u as gt}from"./useAuth.c6840295.js";import{u as vt}from"./useTickets.28877aff.js";import{u as _t}from"./useCliente.042a1fbf.js";import{u as pt}from"./useColaboradores.e01f8fb0.js";import{u as kt}from"./useRepuestos.2ec64f8b.js";var ee=Te({name:"QTooltip",inheritAttrs:!1,props:z(O(O(O({},it),Qe),De),{maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:ve},self:{type:String,default:"top middle",validator:ve},offset:{type:Array,default:()=>[14,14],validator:nt},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}}),emits:[...Be],setup(o,{slots:s,emit:r,attrs:y}){let _,w;const A=$e(),{proxy:{$q:g}}=A,h=E(null),V=E(!1),H=R(()=>_e(o.anchor,g.lang.rtl)),S=R(()=>_e(o.self,g.lang.rtl)),K=R(()=>o.persistent!==!0),{registerTick:L,removeTick:D}=qe(),{registerTimeout:v,removeTimeout:p}=Ne(),{transition:P,transitionStyle:x}=je(o,V),{localScrollTarget:B,changeScrollEvent:$,unconfigureScrollTarget:G}=st(o,ae),{anchorEl:b,canShow:W,anchorEvents:C}=rt({showing:V,configureAnchorEl:Ee}),{show:F,hide:U}=Me({showing:V,canShow:W,handleShow:i,handleHide:n,hideOnRouteChange:K,processOnMount:!0});Object.assign(C,{delayShow:c,delayHide:Se});const{showPortal:q,hidePortal:I,renderPortal:N}=He(A,h,Ae);if(g.platform.is.mobile===!0){const u={anchorEl:b,innerRef:h,onClickOutside(T){return U(T),T.target.classList.contains("q-dialog__backdrop")&&We(T),!0}},J=R(()=>o.modelValue===null&&o.persistent!==!0&&V.value===!0);se(J,T=>{(T===!0?dt:pe)(u)}),re(()=>{pe(u)})}function i(u){D(),p(),q(),L(()=>{w=new MutationObserver(()=>t()),w.observe(h.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),t(),ae()}),_===void 0&&(_=se(()=>g.screen.width+"|"+g.screen.height+"|"+o.self+"|"+o.anchor+"|"+g.lang.rtl,t)),v(()=>{q(!0),r("show",u)},o.transitionDuration)}function n(u){D(),p(),I(),e(),v(()=>{I(!0),r("hide",u)},o.transitionDuration)}function e(){w!==void 0&&(w.disconnect(),w=void 0),_!==void 0&&(_(),_=void 0),G(),ue(C,"tooltipTemp")}function t(){const u=h.value;b.value===null||!u||ut({el:u,offset:o.offset,anchorEl:b.value,anchorOrigin:H.value,selfOrigin:S.value,maxHeight:o.maxHeight,maxWidth:o.maxWidth})}function c(u){if(g.platform.is.mobile===!0){we(),document.body.classList.add("non-selectable");const J=b.value,T=["touchmove","touchcancel","touchend","click"].map(le=>[J,le,"delayHide","passiveCapture"]);de(C,"tooltipTemp",T)}v(()=>{F(u)},o.delay)}function Se(u){p(),g.platform.is.mobile===!0&&(ue(C,"tooltipTemp"),we(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),v(()=>{U(u)},o.hideDelay)}function Ee(){if(o.noParentEvent===!0||b.value===null)return;const u=g.platform.is.mobile===!0?[[b.value,"touchstart","delayShow","passive"]]:[[b.value,"mouseenter","delayShow","passive"],[b.value,"mouseleave","delayHide","passive"]];de(C,"anchor",u)}function ae(){if(b.value!==null||o.scrollTarget!==void 0){B.value=Ke(b.value,o.scrollTarget);const u=o.noParentEvent===!0?t:U;$(B.value,u)}}function Re(){return V.value===!0?te("div",z(O({},y),{ref:h,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",y.class],style:[y.style,x.value],role:"complementary"}),Ge(s.default)):null}function Ae(){return te(Le,{name:P.value,appear:!0},Re)}return re(e),Object.assign(A.proxy,{updatePosition:t}),N}});const yt=["top","middle","bottom"];var Ce=Te({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:o=>yt.includes(o)}},setup(o,{slots:s}){const r=R(()=>o.align!==void 0?{verticalAlign:o.align}:null),y=R(()=>{const _=o.outline===!0&&o.color||o.textColor;return`q-badge flex inline items-center no-wrap q-badge--${o.multiLine===!0?"multi":"single"}-line`+(o.outline===!0?" q-badge--outline":o.color!==void 0?` bg-${o.color}`:"")+(_!==void 0?` text-${_}`:"")+(o.floating===!0?" q-badge--floating":"")+(o.rounded===!0?" q-badge--rounded":"")+(o.transparent===!0?" q-badge--transparent":"")});return()=>te("div",{class:y.value,style:r.value,role:"alert","aria-label":o.label},Fe(s.default,o.label!==void 0?[o.label]:[]))}});const wt={class:"q-pa-md"},ht={class:"q-ml-sm"},Vt={class:"text-pre-wrap"},Ct=f(" No hay estados "),Tt=oe("br",null,null,-1),St=f(" No hay repuestos "),Bt={__name:"TableEdit",setup(o){const s=Je(()=>ze(()=>import("./FormTicket.350b9620.js"),["assets/FormTicket.350b9620.js","assets/FormTicket.de58472d.css","assets/QItem.7ffcb426.js","assets/index.efe594f0.js","assets/index.d6902eec.css","assets/ClosePopup.eeaa7ac3.js","assets/QForm.eb8b336c.js","assets/useCliente.042a1fbf.js","assets/useColaboradores.e01f8fb0.js","assets/Notifications.fda502fa.js","assets/useDispositivo.8c4cd527.js","assets/useTickets.28877aff.js"])),{isAdmin:r}=gt(),{getClienteByRut:y}=_t(),{getAllColaboradores:_,getColabByRut:w}=pt(),{getAllRepuestos:A,getRepuestosSelects:g}=kt(),{getAllTickets:h,deleteTicket:V,getTickets:H,updateTicket:S,getAllEstados:K,getEstadosSelects:L,createMultipleitems:D}=vt();let v=E(!1),p=E(!1),P=E(null);const x=E(""),B=()=>{v.value=!v.value},$=i=>{P.value=i,p.value=!p.value},G=[{name:"id_ticket",align:"center",label:"ID Ticket",field:"ticket",sortable:!0},{name:"clientesRutCliente",align:"center",label:"Cliente",field:"clienteAtendido",sortable:!0},{name:"colaboradoresRutColaborador",align:"center",label:"Qui\xE9n Atendi\xF3",field:"colaboradorAtiende",sortable:!0},{name:"dispositivosIdDispositivo",align:"center",label:"Dispositivo",field:"dispositivoAtendido",sortable:!0},{name:"problema_ticket",align:"center",label:"Problema (Editable)",field:"problemaTicket",sortable:!0},{name:"diagnostico_ticket",align:"center",label:"Dign\xF3stico (Editable)",field:"diagnosticoTicket",sortable:!0},{name:"resolucion_ticket",align:"center",label:"Resoluci\xF3n (Editable)",field:"resolucionTicket",sortable:!0},{name:"estado_ticket",align:"center",label:"Estado",field:"estadoTicket",sortable:!0},{name:"items.repuesto",align:"center",label:"Repuestos",field:"items.repuesto",sortable:!0},{name:"acciones",label:"Acciones",field:"acciones",align:"center"}],b=async(i,n)=>{const e={problema_ticket:n};console.log("editarItemProblema",i,e),await S(i,e)},W=async(i,n)=>{const e={diagnostico_ticket:n};console.log("editarItemDiagnostico",i,e),await S(i,e)},C=async(i,n)=>{const e={resolucion_ticket:n};console.log("editarItemResolucion",i,e),await S(i,e)},F=async(i,n)=>{const e={estado_ticket:n};console.log("editarItemResolucion",i,e),await S(i,e)},U=async(i,n)=>{const t=JSON.parse(JSON.stringify(n)).map(c=>({repuestosIdRepuesto:c.id_repuesto,ticketsIdTicket:i}));console.log("editarItemsRepuestos",i,t),await D(i,t)},q=async i=>{r?(console.log("delete permitido",i),await V(i)):(console.log("no hay permisos"),bt("No tiene permisos de Administrador para eliminar","negative"))},I=[{estado:"Abierto",color:"green"},{estado:"En Progreso",color:"yellow"},{estado:"Terminado",color:"blue"},{estado:"Cancelado",color:"red"}],N=async()=>{await h(),await _(),await K(),await A()};return Xe(async()=>{await N()}),Ye(async()=>{await N()}),(i,n)=>(X(),Y("div",wt,[a(ft,{title:"Administraci\xF3n de Tickets",rows:m(H),columns:G,filter:x.value,"row-key":"name","binary-state-sort":""},{top:l(()=>[a(ce,{modelValue:m(v),"onUpdate:modelValue":n[0]||(n[0]=e=>me(v)?v.value=e:v=e)},{default:l(()=>[a(m(s))]),_:1},8,["modelValue"]),a(ce,{modelValue:m(p),"onUpdate:modelValue":n[2]||(n[2]=e=>me(p)?p.value=e:p=e),persistent:""},{default:l(()=>[a(Ze,{class:""},{default:l(()=>[a(et,{class:"row items-center"},{default:l(()=>[a(tt,{icon:"warning",color:"warning","text-color":"white"}),oe("span",ht,"\xBFEst\xE1s seguro de eliminar el ticket n\xBA "+d(m(P))+"?",1)]),_:1}),a(ot,{align:"right"},{default:l(()=>[fe(a(j,{flat:"",label:"Cancelar",color:"primary"},null,512),[[ye]]),fe(a(j,{flat:"",label:"Confirmar",color:"negative",onClick:n[1]||(n[1]=e=>q(m(P)))},null,512),[[ye]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(j,{color:"primary",label:"A\xF1adir Ticket",icon:"add",onClick:B}),a(ct),a(M,{modelValue:x.value,"onUpdate:modelValue":n[3]||(n[3]=e=>x.value=e),outlined:"",dense:"",debounce:"300",color:"primary"},{append:l(()=>[a(be,{name:"search"})]),_:1},8,["modelValue"])]),body:l(e=>[a(mt,{props:e},{default:l(()=>[a(k,{key:"id_ticket",props:e},{default:l(()=>[f(d(e.row.id_ticket),1)]),_:2},1032,["props"]),a(k,{key:"clientesRutCliente",props:e},{default:l(()=>[f(d(e.row.clientesRutCliente)+" ",1),a(ee,null,{default:l(()=>[f(d(m(y)(e.row.clientesRutCliente).nombre_cliente)+" "+d(m(y)(e.row.clientesRutCliente).appat_cliente)+" "+d(m(y)(e.row.clientesRutCliente).apmat_cliente),1)]),_:2},1024)]),_:2},1032,["props"]),a(k,{key:"colaboradoresRutColaborador",props:e},{default:l(()=>[oe("div",Vt,[f(d(e.row.colaboradoresRutColaborador)+" ",1),a(ee,null,{default:l(()=>[f(d(m(w)(e.row.colaboradoresRutColaborador).nombre_colaborador)+" "+d(m(w)(e.row.colaboradoresRutColaborador).appat_colaborador)+" "+d(m(w)(e.row.colaboradoresRutColaborador).apmat_colaborador),1)]),_:2},1024)])]),_:2},1032,["props"]),a(k,{key:"dispositivosIdDispositivo",props:e},{default:l(()=>{var t;return[f(d(((t=e.row.dispositivos)==null?void 0:t.num_serie_dispositivo)||"Nulo")+" ",1),a(ee,null,{default:l(()=>{var c;return[f(d(((c=e.row.dispositivos)==null?void 0:c.modelo)||"Nulo"),1)]}),_:2},1024)]}),_:2},1032,["props"]),a(k,{key:"problema_ticket",props:e},{default:l(()=>[f(d(e.row.problema_ticket)+" ",1),a(Q,{modelValue:e.row.problema_ticket,"onUpdate:modelValue":t=>e.row.problema_ticket=t,title:"Editar Problema",buttons:"",persistent:"",onSave:t=>b(e.row.id_ticket,t)},{default:l(t=>[a(M,{modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,type:"textarea",autofocus:"",counter:"",onKeyup:n[4]||(n[4]=Z(at(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(k,{key:"diagnostico_ticket",props:e},{default:l(()=>[f(d(e.row.diagnostico_ticket)+" ",1),a(Q,{modelValue:e.row.diagnostico_ticket,"onUpdate:modelValue":t=>e.row.diagnostico_ticket=t,title:"Editar diagn\xF3stico",buttons:"",persistent:"",onSave:t=>W(e.row.id_ticket,t)},{default:l(t=>[a(M,{modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,autofocus:"",type:"textarea",counter:"",onKeyup:Z(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(k,{key:"resolucion_ticket",props:e},{default:l(()=>[f(d(e.row.resolucion_ticket)+" ",1),a(Q,{modelValue:e.row.resolucion_ticket,"onUpdate:modelValue":t=>e.row.resolucion_ticket=t,title:"Editar resoluci\xF3n",buttons:"",persistent:"",onSave:t=>C(e.row.id_ticket,t)},{default:l(t=>[a(M,{modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,autofocus:"",type:"textarea",counter:"",onKeyup:Z(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(k,{key:"estado_ticket",props:e},{default:l(()=>[a(Ce,{color:I[e.row.estado_ticket-1].color},{default:l(()=>[f(d(I[e.row.estado_ticket-1].estado)+" ",1),a(Q,{modelValue:e.estado_ticket,"onUpdate:modelValue":t=>e.estado_ticket=t,title:"Editar estado de ticket",buttons:"",persistent:"",onSave:t=>F(e.row.id_ticket,t.value)},{default:l(t=>[a(ke,{modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,outlined:"","label-color":"primary","input-debounce":"0","map-options":"",behavior:"menu",options:m(L)},{"no-option":l(()=>[a(he,null,{default:l(()=>[a(Ve,{class:"text-grey"},{default:l(()=>[Ct]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["color"])]),_:2},1032,["props"]),a(k,{key:"items.repuesto",props:e},{default:l(()=>[(X(!0),Y(ge,null,lt(e.row.items,t=>(X(),Y(ge,{key:t},[a(Ce,{outline:"",color:"primary"},{default:l(()=>[f(d(t.repuesto),1)]),_:2},1024),Tt],64))),128)),a(Q,{modelValue:e.items,"onUpdate:modelValue":t=>e.items=t,title:"Editar repuestos",buttons:"",persistent:"",onSave:t=>U(e.row.id_ticket,t)},{default:l(t=>[a(ke,{modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,outlined:"","label-color":"primary","input-debounce":"0",multiple:"","map-options":"",behavior:"menu",options:m(g)},{"no-option":l(()=>[a(he,null,{default:l(()=>[a(Ve,{class:"text-grey"},{default:l(()=>[St]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(k,{key:"acciones",props:e},{default:l(()=>[a(j,{push:"",round:"",color:"red",onClick:t=>$(e.row.id_ticket)},{default:l(()=>[a(be,{name:"delete"})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])]))}};export{Bt as default};
