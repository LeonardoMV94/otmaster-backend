import{a5 as $,ca as F,n as b,ap as G,ao as L,aA as Y,Y as h,a4 as a,b3 as n,cj as C,z as m,j as k,ck as H,cl as J,cm as W,Z as A,G as r,cn as X,b5 as U,bS as w,co as c,bR as I,a3 as p,bq as _,br as f}from"./index.6be16f63.js";import{Q as ee,e as te,f as u,g as V,i as ae,C as Q}from"./ClosePopup.d0a73f30.js";import{c as le}from"./Notifications.d579e4b1.js";import{u as oe}from"./useAuth.5537e7f8.js";import{u as ne}from"./useCliente.418f2896.js";import"./QItem.1a96ea91.js";const ie={class:"q-pa-md"},re={class:"q-ml-sm"},ue={class:"text-pre-wrap"},fe={__name:"TableEditCliente",setup(se){const E=$(()=>F(()=>import("./FormCliente.315bc30d.js"),["assets/FormCliente.315bc30d.js","assets/FormCliente.c4738dd3.css","assets/index.6be16f63.js","assets/index.d6902eec.css","assets/QForm.99f3ffd3.js","assets/useCliente.418f2896.js"])),{isAdmin:N}=oe(),{getAllClientes:P,getClientes:T,updateCliente:S,deleteCliente:j}=ne();let s=b(!1),d=b(!1),v=b(null);const y=b(""),x=()=>{s.value=!s.value},K=o=>{v.value=o,d.value=!d.value},O=[{name:"rut_cliente",label:"Rut Cliente",align:"center",field:"rut_cliente",sortable:!0},{name:"nombre_cliente",align:"center",label:"Nombre",field:"nombre_cliente",sortable:!0},{name:"appat_cliente",align:"center",label:"Apellido Paterno",field:"appat_cliente",sortable:!0},{name:"apmat_cliente",align:"center",label:"Apellido Materno",field:"apmat_cliente",sortable:!0},{name:"correo_cliente",align:"center",label:"Correo",field:"correo_cliente",sortable:!0},{name:"tel_cliente",align:"center",label:"Tel\xE9fono",field:"telCliente",sortable:!0},{name:"acciones",align:"center",label:"Acciones",field:"acciones",sortable:!0}],z=async(o,l)=>{const e={nombre_cliente:l};console.log("editarItemNombre",o,e),await S(o,e)},B=async(o,l)=>{const e={appat_cliente:l};console.log("editarItemApPat",o,e),await S(o,e)},D=async(o,l)=>{const e={apmat_cliente:l};console.log("editarItemApMat",o,e),await S(o,e)},M=async(o,l)=>{const e={correo_cliente:l};console.log("editarItemCorreo",o,e),await S(o,e)},Z=async(o,l)=>{const e={tel_cliente:l};console.log("editarItemTel",o,e),await S(o,e)},R=async o=>{N?(console.log("delete permitido",o),await j(o)):(console.log("no hay permisos"),le("No tiene permisos de Administrador para eliminar","negative"))},q=o=>/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/.test(o)||"Email inv\xE1lido",g=async()=>{await P()};return G(async()=>{await g()}),L(async()=>{await g()}),(o,l)=>(Y(),h("div",ie,[a(ae,{title:"Administraci\xF3n de Clientes",rows:m(T),columns:O,filter:y.value,"row-key":"name","binary-state-sort":""},{top:n(()=>[a(C,{modelValue:m(s),"onUpdate:modelValue":l[0]||(l[0]=e=>k(s)?s.value=e:s=e)},{default:n(()=>[a(m(E))]),_:1},8,["modelValue"]),a(C,{modelValue:m(d),"onUpdate:modelValue":l[2]||(l[2]=e=>k(d)?d.value=e:d=e),persistent:""},{default:n(()=>[a(H,{class:""},{default:n(()=>[a(J,{class:"row items-center"},{default:n(()=>[a(W,{icon:"warning",color:"warning","text-color":"white"}),A("span",re,"\xBFEst\xE1s seguro de eliminar el cliente con rut "+r(m(v))+" ?",1)]),_:1}),a(X,{align:"right"},{default:n(()=>[U(a(w,{flat:"",label:"Cancelar",color:"primary"},null,512),[[Q]]),U(a(w,{flat:"",label:"Confirmar",color:"negative",onClick:l[1]||(l[1]=e=>R(m(v)))},null,512),[[Q]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(w,{color:"primary",label:"A\xF1adir nuevo cliente",icon:"add",onClick:x}),a(ee),a(c,{modelValue:y.value,"onUpdate:modelValue":l[3]||(l[3]=e=>y.value=e),outlined:"",dense:"",debounce:"300",color:"primary"},{append:n(()=>[a(I,{name:"search"})]),_:1},8,["modelValue"])]),body:n(e=>[a(te,{props:e},{default:n(()=>[a(u,{key:"rut_cliente",props:e},{default:n(()=>[p(r(e.row.rut_cliente),1)]),_:2},1032,["props"]),a(u,{key:"nombre_cliente",props:e},{default:n(()=>[p(r(e.row.nombre_cliente)+" ",1),a(V,{modelValue:e.row.nombre_cliente,"onUpdate:modelValue":t=>e.row.nombre_cliente=t,title:"Editar Nombre",buttons:"",persistent:"",onSave:t=>z(e.row.rut_cliente,t)},{default:n(t=>[a(c,{modelValue:t.value,"onUpdate:modelValue":i=>t.value=i,autofocus:"",counter:"",mask:"SSSSSSSSSSSSSSSSSSSS","unmasked-value":"",onKeyup:l[4]||(l[4]=_(f(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(u,{key:"appat_cliente",props:e},{default:n(()=>[A("div",ue,[p(r(e.row.appat_cliente)+" ",1),a(V,{modelValue:e.row.appat_cliente,"onUpdate:modelValue":t=>e.row.appat_cliente=t,title:"Editar apellido paterno",buttons:"",persistent:"",onSave:t=>B(e.row.rut_cliente,t)},{default:n(t=>[a(c,{modelValue:t.value,"onUpdate:modelValue":i=>t.value=i,autofocus:"",counter:"",mask:"SSSSSSSSSSSSSSSSSSSS","unmasked-value":"",onKeyup:l[5]||(l[5]=_(f(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])])]),_:2},1032,["props"]),a(u,{key:"apmat_cliente",props:e},{default:n(()=>[p(r(e.row.apmat_cliente)+" ",1),a(V,{modelValue:e.row.apmat_cliente,"onUpdate:modelValue":t=>e.row.apmat_cliente=t,title:"Editar apellido materno",buttons:"",persistent:"",onSave:t=>D(e.row.rut_cliente,t)},{default:n(t=>[a(c,{modelValue:t.value,"onUpdate:modelValue":i=>t.value=i,autofocus:"",counter:"",mask:"SSSSSSSSSSSSSSSSSSSS","unmasked-value":"",onKeyup:l[6]||(l[6]=_(f(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(u,{key:"correo_cliente",props:e},{default:n(()=>[p(r(e.row.correo_cliente)+" ",1),a(V,{modelValue:e.row.correo_cliente,"onUpdate:modelValue":t=>e.row.correo_cliente=t,title:"Editar correo",buttons:"",persistent:"",onSave:t=>M(e.row.rut_cliente,t)},{default:n(t=>[a(c,{modelValue:t.value,"onUpdate:modelValue":i=>t.value=i,autofocus:"",counter:"",rules:[i=>!!i>0||"Ingresa un email.",i=>q(i)],onKeyup:l[7]||(l[7]=_(f(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(u,{key:"tel_cliente",props:e},{default:n(()=>[p(r(e.row.tel_cliente)+" ",1),a(V,{modelValue:e.row.tel_cliente,"onUpdate:modelValue":t=>e.row.tel_cliente=t,title:"Editar tel\xE9fono",buttons:"",persistent:"",onSave:t=>Z(e.row.rut_cliente,t)},{default:n(t=>[a(c,{modelValue:t.value,"onUpdate:modelValue":i=>t.value=i,autofocus:"",counter:"",mask:"(#) ########","unmasked-value":"",onKeyup:l[8]||(l[8]=_(f(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),a(u,{key:"acciones",props:e},{default:n(()=>[a(w,{push:"",round:"",color:"red",onClick:t=>K(e.row.rut_cliente)},{default:n(()=>[a(I,{name:"delete"})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])]))}};export{fe as default};
