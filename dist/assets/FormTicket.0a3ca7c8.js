import{c as K,b as E}from"./QTable.575a901d.js";import{bD as j,n as h,V as g,cE as J,ct as L,an as Y,ae as m,ab as U,bS as M,bO as R,c8 as F,cH as H,cI as c,cJ as p,cK as Z,au as G,ao as X,aA as ee,Y as oe,a4 as r,b3 as u,Z as b,z,bR as Q,cL as te,cM as ae,aD as se,aB as ie,a3 as P}from"./index.ff13323e.js";import{b as N,Q as q}from"./QItem.c941d1bd.js";import{Q as le}from"./QForm.702a5e0b.js";import{u as ne}from"./useCliente.f9eb21ec.js";function I(e,t=new WeakMap){if(Object(e)!==e)return e;if(t.has(e))return t.get(e);const o=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const a=e.valueOf();if(Object(a)!==a){const d=new e.constructor(a);return t.set(e,d),d}}return t.set(e,o),e instanceof Set?e.forEach(a=>{o.add(I(a,t))}):e instanceof Map&&e.forEach((a,d)=>{o.set(d,I(a,t))}),Object.assign(o,...Object.keys(e).map(a=>({[a]:I(e[a],t)})))}var ze=j({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","before-show","show","before-hide","hide"],setup(e,{slots:t,emit:o}){const{proxy:a}=U(),{$q:d}=a,n=h(null),s=h(""),i=h("");let f=!1;const O=g(()=>{const l={initialValue:s.value,validate:e.validate,set:k,cancel:C,updatePosition:w};return J(l,"value",()=>i.value,W=>{i.value=W}),l});function k(){e.validate(i.value)!==!1&&(y()===!0&&(o("save",i.value,s.value),o("update:modelValue",i.value)),S())}function C(){y()===!0&&o("cancel",i.value,s.value),S()}function w(){Y(()=>{n.value.updatePosition()})}function y(){return L(i.value,s.value)===!1}function S(){f=!0,n.value.hide()}function _(){f=!1,s.value=I(e.modelValue),i.value=I(e.modelValue),o("before-show")}function x(){o("show")}function V(){f===!1&&y()===!0&&(e.autoSave===!0&&e.validate(i.value)===!0?(o("save",i.value,s.value),o("update:modelValue",i.value)):o("cancel",i.value,s.value)),o("before-hide")}function A(){o("hide")}Object.assign(a,{set:k,cancel:C,show(l){n.value!==null&&n.value.show(l)},hide(l){n.value!==null&&n.value.hide(l)},updatePosition:w});function v(){const l=t.default!==void 0?[].concat(t.default(O.value)):[];return e.title&&l.unshift(m("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&l.push(m("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[m(M,{flat:!0,color:e.color,label:e.labelCancel||d.lang.label.cancel,onClick:C}),m(M,{flat:!0,color:e.color,label:e.labelSet||d.lang.label.set,onClick:k})])),l}return()=>{if(e.disable!==!0)return m(K,{ref:n,class:"q-popup-edit",cover:e.cover,onBeforeShow:_,onShow:x,onBeforeHide:V,onHide:A,onEscapeKey:C},v)}}}),Qe=j({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:t}){const o=U(),a=g(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return m("td",{class:a.value},R(t.default));const d=o.vnode.key,n=(e.props.colsMap!==void 0?e.props.colsMap[d]:null)||e.props.col;if(n===void 0)return;const{row:s}=e.props;return m("td",{class:a.value+n.__tdClass(s),style:n.__tdStyle(s)},R(t.default))}}}),Ne=j({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:t}){const o=g(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>m("tr",{class:o.value},R(t.default))}});const D=F(),re=H("Colaboradores",{state:()=>({colaboradores:[],colaborador:{}}),getters:{getColaboradores:e=>e.colaboradores,getColaborador:e=>e.colaborador,getOnlyRutCol:e=>e.colaboradores.map(t=>t.rut_colaborador)},actions:{async getAllColaboradores(){const e=await D.getToken;if(e=="")return this.colaboradores;const{data:t}=await c.get("/colaboradores",{headers:{Authorization:`Bearer ${e}`}});console.log("getAllColaboradores ACTIONS: ",t),this.colaboradores=t},async getColaboradoresById(e){const t=D.getToken,{data:o}=await c.get(`/colaboradores/${e}`,{headers:{Authorization:`Bearer ${t}`}});console.log(o),this.colaboradores=o},async createColaboradores(e){const t=await D.getToken;await c.post("/colaboradores/add/",e,{headers:{Authorization:`Bearer ${t}`}}).then(o=>{p.create({message:`Colaborador ${o.data.rut_colaborador} creado exitosamente!`,type:"positive",actions:[{label:"Cerrar",color:"white"}]}),console.log(o)}).catch(o=>{p.create({message:o.response.data.errors[0].message,type:"negative",actions:[{label:"Cerrar",color:"white"}]}),console.log("Error",o.response.data.message)}),this.getAllColaboradores()},async updateColaboradores(e,t){const o=await D.getToken;console.log("updateColaboradores actions:",e,t),await c.put(`colaboradores/update/${e}`,t,{headers:{Authorization:`Bearer ${o}`}}).then(a=>{p.create({message:`Colaborador ${a.data.rut_cliente} actualizado exitosamente!`,type:"positive",actions:[{label:"Cerrar",color:"white"}]}),console.log(a)}).catch(a=>{p.create({message:a.response.data.errors[0].message,type:"negative",actions:[{label:"Cerrar",color:"white"}]}),console.log("Error",a.response.data.message)}),this.getAllColaboradores()},async deleteColaborador(e){const t=D.getToken;await c.delete(`colaboradores/delete/${e}`,{headers:{Authorization:`Bearer ${t}`}}).then(({data:o})=>{p.create({message:`Colaborador ${o} eliminado exitosamente!`,type:"negative",caption:"Cuidado al eliminar!",progress:!0,actions:[{label:"Cerrar",color:"white"}]}),this.colaboradores=this.colaboradores.filter(a=>a.rut_colaborador!==e),console.log("deleteColaborador ACTIONS: ",o)}).catch(o=>{console.log("deleteColaborador ACTIONS: ",o.response.data.message),p.create({message:o.response.data.message,type:"negative",actions:[{label:"Cerrar",color:"white"}]}),console.log("Error",o.response.data.message)}),this.getAllColaboradores()}}}),ce=()=>{const e=re();return{getAllColaboradores:async()=>{await e.getAllColaboradores()},getColaboradorById:async s=>{await e.getColaboradorById(s)},createColaborador:async s=>{console.log("createColaborador useColaborador: ",s),await e.createColaborador(s)},updateColaborador:async(s,i)=>{console.log("updateColaborador useColaborador: ",s,i),await e.updateColaborador(s,i)},deleteColaborador:async s=>{console.log("deleteColaborador useColaborador: ",s),await e.deleteColaborador(s)},getColaboradores:g(()=>e.getColaboradores),getColaborador:g(()=>e.getColaborador),getOnlyRutCol:g(()=>e.getOnlyRutCol)}},T=(e,t)=>{p.create({message:`${e}`,type:t,actions:[{label:"Cerrar",color:"white"}]})},B=F(),de=H("Dispositivos",{state:()=>({dispositivos:[],dispositivo:{}}),getters:{getDispositivos:e=>e.dispositivos,getDispositivo:e=>e.dispositivo,getOnlyIdDispositivos:e=>e.dispositivos.map(t=>t.id_dispositivo)},actions:{async getAllDispositivos(){const e=await B.getToken;if(e=="")return this.dispositivos;const{data:t}=await c.get("/dispositivos/",{headers:{Authorization:`Bearer ${e}`}});console.log("getAllDispositivos ACTIONS: ",t),this.dispositivos=t},async getTDById(e){const t=await B.getToken,{data:o}=await c.get(`/dispositivos/${e}`,{headers:{Authorization:`Bearer ${t}`}});console.log(o),this.dispositivo=o},async createDispositivo(e){const t=await B.getToken;await c.post("/dispositivos/add/",e,{headers:{Authorization:`Bearer ${t}`}}).then(o=>{T(`Dispositivo ${o.data.id_dispositivo} creado exitosamente!`,"positive"),console.log(o)}).catch(o=>{T(o.response.data.errors[0].message,"negative"),console.log("Error",o.response.data.message)}),this.getAllDispositivos()},async updateDispositivo(e,t){const o=await B.getToken;console.log("updateDispositivo actions:",e,t),await c.put(`dispositivos/update/${e}`,t,{headers:{Authorization:`Bearer ${o}`}}).then(a=>{T(`Tipo Dispositivo ${a.data.id_rol} actualizado exitosamente!`,"positive"),console.log(a)}).catch(a=>{T(a.response.data.errors[0].message,"negative"),console.log("Error",a.response.data.message)}),this.getAllDispositivos()},async deleteDispositivo(e){const t=await B.getToken;await c.delete(`dispositivos/delete/${e}`,{headers:{Authorization:`Bearer ${t}`}}).then(({data:o})=>{T(`Tipo Dispositivo ${o} eliminado exitosamente!`,"positive"),this.roles=this.roles.filter(a=>a.id_dispositivo!==e),console.log("deleteDispositivo ACTIONS: ",o)}).catch(o=>{console.log("deleteDispositivo ACTIONS: ",o.response.data.message),T(o.response.data.message,"negative"),console.log("Error",o.response.data.message)}),this.getAllDispositivos()}}}),ue=()=>{const e=de();return{getAllDispositivos:async()=>{await e.getAllDispositivos()},getDispositivoById:async s=>{await e.getTDById(s)},createDispositivo:async s=>{console.log("createDispositivo ",s),await e.createDispositivo(s)},updateDispositivo:async(s,i)=>{console.log("updateDispositivo",s,i),await e.updateDispositivo(s,i)},deleteDispositivo:async s=>{console.log("deleteDispositivo useDispositivo: ",s),await e.deleteDispositivo(s)},getDispositivos:g(()=>e.getDispositivos),getDispositivo:g(()=>e.getDispositivo),getOnlyIdDispositivos:g(()=>e.getOnlyIdDispositivos)}},$=F(),pe=H("tickets",{state:()=>({tickets:[],ticket:{}}),getters:{getTickets:e=>e.tickets,getTicket:e=>e.ticket},actions:{async getAllTickets(){const e=$.getToken;if(e=="")return this.tickets;const{data:t}=await c.get("/tickets",{headers:{Authorization:`Bearer ${e}`}});console.log("getAllTickets ACTIONS: ",t),this.tickets=t},async getTicketById(e){const t=$.getToken,{data:o}=await c.get(`/tickets/${e}`,{headers:{Authorization:`Bearer ${t}`}});console.log(o),this.cliente=o},async createTicket(e){const t=await $.getToken;await c.post("/tickets/add/",e,{headers:{Authorization:`Bearer ${t}`}}).then(o=>{console.log(o.data.id_ticket),p.create({message:`Ticket ${o.data.id_ticket} creado exitosamente!`,type:"positive",actions:[{label:"Cerrar",color:"white"}]}),console.log(o)}).catch(o=>{p.create({message:o.response.data,type:"negative",actions:[{label:"Cerrar",color:"white"}]}),console.log("Error",o.response.data.message)}),this.getAllTickets()},async updateTicket(e,t){const o=$.getToken;console.log("updateticket actions:",e,t),await c.put(`tickets/update/${e}`,t,{headers:{Authorization:`Bearer ${o}`}}).then(a=>{p.create({message:`Cliente ${a.data.id_ticket} actualizado exitosamente!`,type:"positive",actions:[{label:"Cerrar",color:"white"}]}),console.log(a)}).catch(a=>{p.create({message:a.response.data.errors[0].message,type:"negative",actions:[{label:"Cerrar",color:"white"}]}),console.log("Error",a.response.data.message)}),this.getAllTickets()},async deleteTicket(e){const t=$.getToken;await c.delete(`tickets/delete/${e}`,{headers:{Authorization:`Bearer ${t}`}}).then(({data:o})=>{p.create({message:`Ticket ${o.id} eliminado exitosamente!`,type:"negative",caption:"Cuidado al eliminar!",progress:!0,actions:[{label:"Cerrar",color:"white"}]}),this.clientes=this.clientes.filter(a=>a.id_ticket!==e),console.log("deleteTicket ACTIONS: ",o)}).catch(o=>{console.log("deleteTicket ACTIONS: ",o.response.data.message),p.create({message:o.response.data.message,type:"negative",actions:[{label:"Cerrar",color:"white"}]}),console.log("Error",o.response.data.message)}),this.getAllTickets()}}}),ge=()=>{const e=pe();return{getAllTickets:async()=>{await e.getAllTickets()},getTicketById:async s=>{await e.getTicketById(s)},createTicket:async s=>{console.log("createTicket ",s),await e.createTicket(s)},updateTicket:async(s,i)=>{console.log("updateTicket",s,i),await e.updateTicket(s,i)},deleteTicket:async s=>{console.log("deleteTicket useTicket: ",s),await e.deleteTicket(s)},getTickets:g(()=>e.getTickets),getTicket:g(()=>e.getTicket)}};const ve=e=>(se("data-v-39de8a78"),e=e(),ie(),e),be={style:{width:"700px","max-width":"80vw"}},he=ve(()=>b("h4",{class:"text-center"},"Crear Ticket (OT)",-1)),me={class:"row"},ke={class:"col"},ye=P(" No hay Clientes "),fe={class:"row"},Ce={class:"col"},we=P(" No hay colaboradores "),Te={class:"row"},_e={class:"col"},Ae=P(" No hay dispositivos "),De={class:"row"},Be={class:"col"},$e={class:"row justify-center"},Ie={__name:"FormTicket",setup(e){const{getAllClientes:t,getOnlyRuts:o}=ne(),{getAllColaboradores:a,getOnlyRutCol:d}=ce(),{getAllDispositivos:n,getOnlyIdDispositivos:s}=ue(),{createTicket:i}=ge();G(async()=>{await f()}),X(async()=>{await f()});const f=async()=>{await t(),await a(),await n()},O=o.value,k=h(null),C=d.value,w=h(null),y=h(null),S=s.value,_=h(null),x=h(1),V=async()=>{const A={clientesRutCliente:k.value,colaboradoresRutColaborador:w.value,dispositivosIdDispositivo:y.value,problema_ticket:_.value,estado_ticket:x.value};await i(A)};return(A,v)=>(ee(),oe("div",be,[r(ae,{class:"q-pa-sm"},{default:u(()=>[he,r(le,{onSubmit:V},{default:u(()=>[b("div",me,[b("div",ke,[r(E,{modelValue:k.value,"onUpdate:modelValue":v[0]||(v[0]=l=>k.value=l),outlined:"","use-input":"","input-debounce":"0",label:"Elija un cliente",options:z(O),behavior:"menu",onFilter:A.filterFn},{"no-option":u(()=>[r(N,null,{default:u(()=>[r(q,{class:"text-grey"},{default:u(()=>[ye]),_:1})]),_:1})]),append:u(()=>[r(Q,{name:"person",color:"black"})]),_:1},8,["modelValue","options","onFilter"])])]),b("div",fe,[b("div",Ce,[r(E,{modelValue:w.value,"onUpdate:modelValue":v[1]||(v[1]=l=>w.value=l),outlined:"","use-input":"","input-debounce":"0",label:"Colaborador que atiende",options:z(C),behavior:"menu"},{"no-option":u(()=>[r(N,null,{default:u(()=>[r(q,{class:"text-grey"},{default:u(()=>[we]),_:1})]),_:1})]),append:u(()=>[r(Q,{name:"support_agent",color:"black"})]),_:1},8,["modelValue","options"])])]),b("div",Te,[b("div",_e,[r(E,{modelValue:y.value,"onUpdate:modelValue":v[2]||(v[2]=l=>y.value=l),outlined:"","use-input":"","input-debounce":"0",label:"Dispositivo a reparar",options:z(S),behavior:"menu"},{"no-option":u(()=>[r(N,null,{default:u(()=>[r(q,{class:"text-grey"},{default:u(()=>[Ae]),_:1})]),_:1})]),append:u(()=>[r(Q,{name:"devices_other",color:"black"})]),_:1},8,["modelValue","options"])])]),b("div",De,[b("div",Be,[r(te,{modelValue:_.value,"onUpdate:modelValue":v[3]||(v[3]=l=>_.value=l),label:"Describa el problema... *",type:"textarea",outlined:""},null,8,["modelValue"])])]),b("div",$e,[r(M,{label:"Agregar",type:"submit",color:"primary"})])]),_:1})]),_:1})]))}};var qe=Z(Ie,[["__scopeId","data-v-39de8a78"]]);export{qe as F,Ne as Q,Qe as a,ze as b,ge as u};
