import{c8 as O,cb as P,cc as R,V as M,a5 as j,ca as q,n as f,ap as K,ao as F,aA as G,Y as L,a4 as t,b3 as a,cj as k,z as g,j as C,ck as Y,cl as Z,cm as H,Z as J,G as v,cn as W,b5 as T,bS as w,co as S,bR as I,a3 as Q,bq as X,br as ee}from"./index.6be16f63.js";import{Q as te,e as oe,f as _,g as se,i as ae,C as B}from"./ClosePopup.d0a73f30.js";import{c as d}from"./Notifications.d579e4b1.js";import{u as le}from"./useAuth.5537e7f8.js";const N=O(),ne=P("repuestos",{state:()=>({repuestos:[]}),getters:{getRepuestos:o=>o.repuestos},actions:{async getAllRepuestos(){const o=await N.getToken;if(o=="")return this.repuestos;const{data:l}=await R.get("/repuestos/",{headers:{Authorization:`Bearer ${o}`}});console.log("getAllMarcaDispositivos ACTIONS: ",l),this.repuestos=l},async createRepuesto(o){console.log("createRepuesto: ",o);const l=N.getToken;await R.post("/repuestos/add/",o,{headers:{Authorization:`Bearer ${l}`}}).then(s=>{d(`Repuesto ${s.data.id_repuesto} creado exitosamente!`,"positive"),console.log(s)}).catch(s=>{d(s.response.data.message,"negative"),console.log("Error",s.response.data.message)}),this.getAllRepuestos()},async updateRepuesto(o,l){const s=N.getToken;console.log("updateRepuesto actions:",o,l),await R.patch(`repuestos/${o}`,l,{headers:{Authorization:`Bearer ${s}`}}).then(u=>{d(`Repuesto ${u.data.id_repuesto} actualizado exitosamente!`,"positive"),console.log(u)}).catch(u=>{d(u.response.data.errors[0].message,"negative"),console.log("Error",u.response.data.message)}),this.getAllRepuestos()},async deleteRepuesto(o){const l=N.getToken;await R.delete(`repuestos/delete/${o}`,{headers:{Authorization:`Bearer ${l}`}}).then(({data:s})=>{d(`Repuesto ${s.id_repuesto} eliminado exitosamente!`,"negative"),console.log("antes ",this.repuestos),this.repuestos=this.repuestos.filter(u=>u.id_repuesto!==o),console.log("despues",this.repuestos),console.log("deleteRepuesto ACTIONS: ",s)}).catch(s=>{console.log("deleteRepuesto ACTIONS: ",s.response.data.message),d(s.response.data.message,"negative"),console.log("Error",s.response.data.message)})}}}),re=()=>{const o=ne();return{getAllRepuestos:async()=>{await o.getAllRepuestos()},getRepuestoById:async n=>{await o.getRepuestoById(n)},createNewRepuesto:async n=>{console.log("createRepuesto ",n),await o.createRepuesto(n)},updateRepuesto:async(n,i)=>{console.log("updateRepuesto",n,i),await o.updateRepuesto(n,i)},deleteRepuesto:async n=>{console.log("deleteRepuesto useRepuesto: ",n),await o.deleteRepuesto(n)},getRepuestos:M(()=>o.getRepuestos)}},ue={class:"q-pa-md"},ie={class:"q-ml-sm"},pe={__name:"TableEditRepuestos",setup(o){const l=j(()=>q(()=>import("./FormRepuesto.bd855fdd.js"),["assets/FormRepuesto.bd855fdd.js","assets/FormRepuesto.d7ead791.css","assets/index.6be16f63.js","assets/index.d6902eec.css","assets/QForm.99f3ffd3.js","assets/ClosePopup.d0a73f30.js","assets/QItem.1a96ea91.js","assets/Notifications.d579e4b1.js","assets/useAuth.5537e7f8.js"])),{isAdmin:s}=le(),{getAllRepuestos:u,getRepuestos:b,updateRepuesto:A,deleteRepuesto:n}=re();let i=f(!1),m=f(!1),y=f(null);const h=f(""),E=()=>{i.value=!i.value},$=p=>{y.value=p,m.value=!m.value},x=[{name:"id_repuesto",label:"ID repuesto",align:"center",field:"id_repuesto",sortable:!0},{name:"repuesto",align:"center",label:"Nombre del repuesto",field:"repuesto",sortable:!0},{name:"acciones",align:"center",label:"Acciones",field:"acciones",sortable:!0}],z=async(p,r)=>{const e={repuesto:r};console.log("editarItemNombreRepuesto",p,e),await A(p,e)},D=async p=>{s?(console.log("delete permitido",p),await n(p)):(console.log("no hay permisos"),d("No tiene permisos de Administrador para eliminar","negative"))},V=async()=>{await u()};return K(async()=>{await V()}),F(async()=>{await V()}),(p,r)=>(G(),L("div",ue,[t(ae,{title:"Administraci\xF3n de Repuestos",rows:g(b),columns:x,filter:h.value,"row-key":"name","binary-state-sort":""},{top:a(()=>[t(k,{modelValue:g(i),"onUpdate:modelValue":r[0]||(r[0]=e=>C(i)?i.value=e:i=e)},{default:a(()=>[t(g(l))]),_:1},8,["modelValue"]),t(k,{modelValue:g(m),"onUpdate:modelValue":r[2]||(r[2]=e=>C(m)?m.value=e:m=e),persistent:""},{default:a(()=>[t(Y,{class:""},{default:a(()=>[t(Z,{class:"row items-center"},{default:a(()=>[t(H,{icon:"warning",color:"warning","text-color":"white"}),J("span",ie,"\xBFEst\xE1s seguro de eliminar el repuesto con ID "+v(g(y))+" ?",1)]),_:1}),t(W,{align:"right"},{default:a(()=>[T(t(w,{flat:"",label:"Cancelar",color:"primary"},null,512),[[B]]),T(t(w,{flat:"",label:"Confirmar",color:"negative",onClick:r[1]||(r[1]=e=>D(g(y)))},null,512),[[B]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(w,{color:"primary",label:"A\xF1adir nuevo repuesto",icon:"add",onClick:E}),t(te),t(S,{modelValue:h.value,"onUpdate:modelValue":r[3]||(r[3]=e=>h.value=e),outlined:"",dense:"",debounce:"300",color:"primary"},{append:a(()=>[t(I,{name:"search"})]),_:1},8,["modelValue"])]),body:a(e=>[t(oe,{props:e},{default:a(()=>[t(_,{key:"id_repuesto",props:e},{default:a(()=>[Q(v(e.row.id_repuesto),1)]),_:2},1032,["props"]),t(_,{key:"repuesto",props:e},{default:a(()=>[Q(v(e.row.repuesto)+" ",1),t(se,{modelValue:e.row.repuesto,"onUpdate:modelValue":c=>e.row.repuesto=c,title:"Editar nombre de repuesto",buttons:"",persistent:"",onSave:c=>z(e.row.id_repuesto,c)},{default:a(c=>[t(S,{modelValue:c.value,"onUpdate:modelValue":U=>c.value=U,autofocus:"",counter:"",clearable:"",mask:"NNNNNNNNNNNNNNNNNNNNNN","unmasked-value":"",onKeyup:r[4]||(r[4]=X(ee(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),t(_,{key:"acciones",props:e},{default:a(()=>[t(w,{push:"",round:"",color:"red",onClick:c=>$(e.row.id_repuesto)},{default:a(()=>[t(I,{name:"delete"})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])]))}};var Re=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"}));export{Re as T,re as u};
