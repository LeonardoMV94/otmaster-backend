import{a5 as F,ca as G,n as p,ap as L,ao as Y,aA as Z,Y as H,a4 as e,b3 as l,cj as A,z as d,j as U,ck as J,cl as W,cm as X,Z as Q,G as i,cn as $,b5 as I,bS as _,co as f,bR as S,a3 as c,bq as y,br as g}from"./index.efe594f0.js";import{Q as oo,e as eo,f as m,g as V,h as ao,i as lo,C as k}from"./ClosePopup.eeaa7ac3.js";import{b as to,Q as ro}from"./QItem.7ffcb426.js";import{c as no}from"./Notifications.fda502fa.js";import{u as so}from"./useAuth.c6840295.js";import{u as uo}from"./useColaboradores.e01f8fb0.js";import{u as io}from"./useRoles.1f96d514.js";const mo={class:"q-pa-md"},co={class:"q-ml-sm"},bo={class:"text-pre-wrap"},po=c(" No hay roles "),Ao={__name:"TableEditColaborador",setup(_o){const R=F(()=>G(()=>import("./FormColaborador.55634dbb.js"),["assets/FormColaborador.55634dbb.js","assets/FormColaborador.e24d07a8.css","assets/index.efe594f0.js","assets/index.d6902eec.css","assets/QItem.7ffcb426.js","assets/ClosePopup.eeaa7ac3.js","assets/QForm.eb8b336c.js","assets/useRoles.1f96d514.js","assets/Notifications.fda502fa.js","assets/useColaboradores.e01f8fb0.js"])),{isAdmin:E}=so(),{getAllRoles:N,getRolestoSelect:h}=io(),{getAllColaboradores:x,getColaboradores:P,updateColaborador:b,deleteColaborador:T}=uo();let s=p(!1),u=p(!1),w=p(null);const v=p(""),j=()=>{s.value=!s.value},B=r=>{w.value=r,u.value=!u.value},D=[{name:"rut_colaborador",label:"Rut Colaborador",align:"center",field:"rut_colaborador",sortable:!0},{name:"nombre_colaborador",align:"center",label:"Nombre Colaborador",field:"nombreColaborador",sortable:!0},{name:"appat_colaborador",align:"center",label:"Apellido Paterno",field:"appat_colaborador",sortable:!0},{name:"apmat_colaborador",align:"center",label:"Apellido Materno",field:"apmat_colaborador",sortable:!0},{name:"roles.nombre_rol",align:"center",label:"Tipo de Rol",field:"roles.nombre_rol",sortable:!0},{name:"acciones",label:"Acciones",field:"acciones",align:"center"}],M=async(r,t)=>{const o={nombre_colaborador:t};console.log("editarItemNombre",r,o),await b(r,o)},O=async(r,t)=>{const o={appat_colaborador:t};console.log("editarItemApPat",r,o),await b(r,o)},K=async(r,t)=>{const o={apmat_colaborador:t};console.log("editarItemApMat",r,o),await b(r,o)},q=async(r,t)=>{const o={rolesIdRol:t};console.log("editarItemRol",r,o),await b(r,o)},z=async r=>{E?(console.log("delete permitido",r),await T(r)):(console.log("no hay permisos"),no("No tiene permisos de Administrador para eliminar","negative"))},C=async()=>{await x(),await N()};return L(async()=>{await C()}),Y(async()=>{await C()}),(r,t)=>(Z(),H("div",mo,[e(lo,{title:"Administraci\xF3n de Colaboradores",rows:d(P),columns:D,filter:v.value,"row-key":"name","binary-state-sort":""},{top:l(()=>[e(A,{modelValue:d(s),"onUpdate:modelValue":t[0]||(t[0]=o=>U(s)?s.value=o:s=o)},{default:l(()=>[e(d(R))]),_:1},8,["modelValue"]),e(A,{modelValue:d(u),"onUpdate:modelValue":t[2]||(t[2]=o=>U(u)?u.value=o:u=o),persistent:""},{default:l(()=>[e(J,{class:""},{default:l(()=>[e(W,{class:"row items-center"},{default:l(()=>[e(X,{icon:"warning",color:"warning","text-color":"white"}),Q("span",co,"\xBFEst\xE1s seguro de eliminar el colaborador con rut "+i(d(w))+" ?",1)]),_:1}),e($,{align:"right"},{default:l(()=>[I(e(_,{flat:"",label:"Cancelar",color:"primary"},null,512),[[k]]),I(e(_,{flat:"",label:"Confirmar",color:"negative",onClick:t[1]||(t[1]=o=>z(d(w)))},null,512),[[k]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(_,{color:"primary",label:"A\xF1adir Colaborador",icon:"add",onClick:j}),e(oo),e(f,{modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=o=>v.value=o),outlined:"",dense:"",debounce:"300",color:"primary"},{append:l(()=>[e(S,{name:"search"})]),_:1},8,["modelValue"])]),body:l(o=>[e(eo,{props:o},{default:l(()=>[e(m,{key:"rut_colaborador",props:o},{default:l(()=>[c(i(o.row.rut_colaborador),1)]),_:2},1032,["props"]),e(m,{key:"nombre_colaborador",props:o},{default:l(()=>[c(i(o.row.nombre_colaborador)+" ",1),e(V,{modelValue:o.row.nombre_colaborador,"onUpdate:modelValue":a=>o.row.nombre_colaborador=a,title:"Editar Nombre",buttons:"",persistent:"",onSave:a=>M(o.row.rut_colaborador,a)},{default:l(a=>[e(f,{modelValue:a.value,"onUpdate:modelValue":n=>a.value=n,autofocus:"",counter:"",onKeyup:t[4]||(t[4]=y(g(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),e(m,{key:"appat_colaborador",props:o},{default:l(()=>[Q("div",bo,[c(i(o.row.appat_colaborador)+" ",1),e(V,{modelValue:o.row.appat_colaborador,"onUpdate:modelValue":a=>o.row.appat_colaborador=a,title:"Editar apellido paterno",buttons:"",persistent:"",onSave:a=>O(o.row.rut_colaborador,a)},{default:l(a=>[e(f,{modelValue:a.value,"onUpdate:modelValue":n=>a.value=n,autofocus:"",counter:"",onKeyup:t[5]||(t[5]=y(g(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])])]),_:2},1032,["props"]),e(m,{key:"apmat_colaborador",props:o},{default:l(()=>[c(i(o.row.apmat_colaborador)+" ",1),e(V,{modelValue:o.row.apmat_colaborador,"onUpdate:modelValue":a=>o.row.apmat_colaborador=a,title:"Editar apellido materno",buttons:"",persistent:"",onSave:a=>K(o.row.rut_colaborador,a)},{default:l(a=>[e(f,{modelValue:a.value,"onUpdate:modelValue":n=>a.value=n,autofocus:"",counter:"",onKeyup:t[6]||(t[6]=y(g(()=>{},["stop"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),e(m,{key:"roles.nombre_rol",props:o},{default:l(()=>[c(i(o.row.roles.nombre_rol)+" ",1),e(V,{modelValue:o.rolesIdRol,"onUpdate:modelValue":a=>o.rolesIdRol=a,title:"Editar rol",buttons:"",persistent:"",onSave:a=>q(o.row.rut_colaborador,a.id_rol)},{default:l(a=>[e(ao,{modelValue:a.value,"onUpdate:modelValue":n=>a.value=n,outlined:"","label-color":"primary","input-debounce":"0","map-options":"",behavior:"menu",options:d(h)},{"no-option":l(()=>[e(to,null,{default:l(()=>[e(ro,{class:"text-grey"},{default:l(()=>[po]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),_:2},1032,["modelValue","onUpdate:modelValue","onSave"])]),_:2},1032,["props"]),e(m,{key:"acciones",props:o},{default:l(()=>[e(_,{push:"",round:"",color:"red",onClick:a=>B(o.row.rut_colaborador)},{default:l(()=>[e(S,{name:"delete"})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])]))}};export{Ao as default};
